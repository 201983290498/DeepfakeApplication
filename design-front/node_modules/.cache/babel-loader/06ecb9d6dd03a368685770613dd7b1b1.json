{"ast":null,"code":"import ServiceDisplay from '../components/ServiceDisplay';\nimport ServiceModule from '../components/ServiceModule';\nimport ServiceUpload from '../components/ServiceUpload';\nimport ServiceTitle from '../components/ServiceTitle';\nimport $ from 'jquery';\nexport default {\n  name: 'DeepFakeDetector',\n  components: {\n    ServiceDisplay,\n    ServiceModule,\n    ServiceTitle,\n    ServiceUpload\n  },\n  data() {\n    return {\n      title: 'DeepFake篡改检测',\n      deepfakeDetector: window.server.DEEPFAKE,\n      disImgs: [require('../../static/imgs/fake1.jpg'), require('../../static/imgs/fake2.jpg'), require('../../static/imgs/real1.jpg')]\n    };\n  },\n  methods: {\n    uploadFile: function (imgs) {\n      // 上传文件返回结果\n      const _this = this;\n      // todo 学习 element-ui中确认消息框的使用， jquery需要引入脚本jq-confirm.js\n      $.ajax({\n        type: 'post',\n        url: _this.deepfakeDetector.detectUrl,\n        dataType: 'json',\n        contentType: 'application/json',\n        data: JSON.stringify(imgs),\n        success: function (response) {\n          if (response.result) {\n            // 通过base64字符串加载图片\n            const image = new Image();\n            image.src = imgs.base64;\n            image.crossOrigin = '';\n            image.onload = function () {\n              _this.drawDetections(image, response.data.rects);\n            };\n          } else {\n            // 显示错误信息\n            _this.$message.warning(response.msg);\n          }\n        },\n        xhr: function () {\n          const xhr = new window.XMLHttpRequest();\n          // todo 学习 使用XMLHttpRequest.upload监听上传过程，注册progress事件，打印回调函数中的event事件\n          xhr.upload.addEventListener('progress', function (event) {\n            // todo 待更新 需要查看更新的内容\n            if (event.lengthComputable) {\n              const percentComplete = event.loaded / event.total;\n              _this.uploaded = parseInt(String(percentComplete * 100));\n            }\n          }, false);\n          return xhr;\n        }\n      });\n    },\n    drawDetections: function (img, detections) {\n      const canvas = document.createElement('canvas');\n      canvas.width = img.width;\n      canvas.height = img.height;\n      const ctx = canvas.getContext('2d');\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n    }\n  }\n};","map":{"version":3,"mappings":"AAWA;AACA;AACA;AACA;AACA;AAEA;EACAA;EACAC;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MAAA;MACA;MACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAV;QACAW;UACA;YACA;YACA;YACAC;YACAA;YACAA;cACAC;YACA;UACA;YACA;YACAA;UACA;QACA;QACAC;UACA;UACA;UACAA;YACA;YACA;cACA;cACAD;YACA;UACA;UACA;QACA;MACA;IACA;IACAE;MACA;MACAC;MACAA;MACA;MACAC;IACA;EACA;AACA","names":["name","components","ServiceDisplay","ServiceModule","ServiceTitle","ServiceUpload","data","title","deepfakeDetector","disImgs","methods","uploadFile","$","type","url","dataType","contentType","success","image","_this","xhr","drawDetections","canvas","ctx"],"sourceRoot":"src/views","sources":["DeepFakeDetector.vue"],"sourcesContent":["<template>\n  <div class=\"df-detector\">\n    <ServiceTitle :titleHeader=\"title\"></ServiceTitle>\n    <ServiceModule></ServiceModule>\n    <ServiceDisplay :disImgs='disImgs' @upload=\"uploadFile\"></ServiceDisplay>\n    <ServiceUpload @upload='uploadFile'></ServiceUpload>\n  </div>\n</template>\n<!--components为啥要用大括号呢-->\n\n<script>\nimport ServiceDisplay from '../components/ServiceDisplay'\nimport ServiceModule from '../components/ServiceModule'\nimport ServiceUpload from '../components/ServiceUpload'\nimport ServiceTitle from '../components/ServiceTitle'\nimport $ from 'jquery'\n\nexport default {\n  name: 'DeepFakeDetector',\n  components: {\n    ServiceDisplay,\n    ServiceModule,\n    ServiceTitle,\n    ServiceUpload\n  },\n  data () {\n    return {\n      title: 'DeepFake篡改检测',\n      deepfakeDetector: window.server.DEEPFAKE,\n      disImgs: [require('../../static/imgs/fake1.jpg'), require('../../static/imgs/fake2.jpg'), require('../../static/imgs/real1.jpg')]\n    }\n  },\n  methods: {\n    uploadFile: function (imgs) { // 上传文件返回结果\n      const _this = this\n      // todo 学习 element-ui中确认消息框的使用， jquery需要引入脚本jq-confirm.js\n      $.ajax({\n        type: 'post',\n        url: _this.deepfakeDetector.detectUrl,\n        dataType: 'json',\n        contentType: 'application/json',\n        data: JSON.stringify(imgs),\n        success: function (response) {\n          if (response.result) {\n            // 通过base64字符串加载图片\n            const image = new Image()\n            image.src = imgs.base64\n            image.crossOrigin = ''\n            image.onload = function () {\n              _this.drawDetections(image, response.data.rects)\n            }\n          } else {\n            // 显示错误信息\n            _this.$message.warning(response.msg)\n          }\n        },\n        xhr: function () {\n          const xhr = new window.XMLHttpRequest()\n          // todo 学习 使用XMLHttpRequest.upload监听上传过程，注册progress事件，打印回调函数中的event事件\n          xhr.upload.addEventListener('progress', function (event) {\n            // todo 待更新 需要查看更新的内容\n            if (event.lengthComputable) {\n              const percentComplete = event.loaded / event.total\n              _this.uploaded = parseInt(String(percentComplete * 100))\n            }\n          }, false)\n          return xhr\n        }\n      })\n    },\n    drawDetections: function (img, detections) {\n      const canvas = document.createElement('canvas')\n      canvas.width = img.width\n      canvas.height = img.height\n      const ctx = canvas.getContext('2d')\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height)\n    }\n  }\n}\n</script>\n"]},"metadata":{},"sourceType":"module"}